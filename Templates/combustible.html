{% extends "layout.html" %}
{% block title %}Reporte de Combustible{% endblock %}
{% block main %}
<div class="container mt-4">
    <h3 class="mb-3 text-primary text-center">Reporte de Gasto de Combustibles</h3>
    
    <!-- FORMULARIO DE REGISTRO -->
    <form method="post" class="row g-3 mb-4 border rounded-3 p-3 bg-light">
        <h5 class="mb-3">Registrar Gasto de Combustible</h5>
        <div class="col-12 col-md-2 mb-2">
            <label class="form-label">Fecha:</label>
            <input type="date" name="fecha" class="form-control" required>
        </div>
        <div class="col-12 col-md-2 mb-2">
            <label class="form-label">Vehículo:</label>
            <select name="vehiculo" class="form-select" required>
                <option value="">Seleccione</option>
                {% for v in vehiculos %}
                    <option value="{{ v.ID_Vehiculo }}">{{ v.Placa }} - {{ v.Marca }} {{ v.Modelo }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-12 col-md-2 mb-2">
            <label class="form-label">Monto (C$):</label>
            <input type="number" step="0.01" name="monto" class="form-control" required>
        </div>
        <div class="col-12 col-md-1 mb-2">
            <label class="form-label">Litros:</label>
            <input type="number" step="0.01" name="litros" class="form-control">
        </div>
        <div class="col-12 col-md-2 mb-2">
            <label class="form-label">Kilometraje:</label>
            <input type="number" name="kilometraje" class="form-control">
        </div>
        <div class="col-12 col-md-2 mb-2">
            <label class="form-label">Bodega:</label>
            <select name="bodega" class="form-select">
                <option value="">Seleccione</option>
                {% for b in bodegas %}
                    <option value="{{ b.ID_Bodega }}">{{ b.Nombre }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-12 mb-2">
            <label class="form-label">Observación:</label>
            <input type="text" name="observacion" class="form-control">
        </div>
        <div class="col-12 col-md-2">
            <button type="submit" class="btn btn-success w-100 mt-2">Registrar</button>
        </div>
    </form>

    <!-- FORMULARIO DE FILTRO -->
    <form method="get" class="row mb-3 g-2 justify-content-center">
        <div class="col-12 col-sm-6 col-md-3">
            <label class="form-label">Fecha:</label>
            <input type="date" name="fecha" class="form-control" value="{{ fecha or '' }}">
        </div>
        <div class="col-12 col-sm-6 col-md-3">
            <label class="form-label">Vehículo:</label>
            <select name="vehiculo" class="form-select">
                <option value="">Todos</option>
                {% for v in vehiculos %}
                    <option value="{{ v.ID_Vehiculo }}" {% if id_vehiculo|int == v.ID_Vehiculo %}selected{% endif %}>
                        {{ v.Placa }} - {{ v.Marca }} {{ v.Modelo }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-12 col-md-2 align-self-end">
            <button type="submit" class="btn btn-primary w-100">Buscar</button>
        </div>
    </form>

    <!-- TABLA DE REGISTROS -->
    <div class="table-responsive-sm">
        <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Fecha</th>
                    <th>Vehículo</th>
                    <th>Monto (C$)</th>
                    <th>Litros</th>
                    <th>Kilometraje</th>
                    <th>Observación</th>
                </tr>
            </thead>
            <tbody>
                {% for row in gastos %}
                <tr>
                    <td>{{ row.Fecha }}</td>
                    <td>{{ row.Placa }} - {{ row.Marca }} {{ row.Modelo }}</td>
                    <td>{{ row.Monto }}</td>
                    <td>{{ row.Litros or '' }}</td>
                    <td>{{ row.Kilometraje or '' }}</td>
                    <td>{{ row.Observacion }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="text-center text-muted">No hay registros para mostrar.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
